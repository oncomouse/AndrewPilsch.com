!!! 5
-# paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/
<!--[if lt IE 7]> <html lang="en" class="no-js ie6"> <![endif]-->
<!--[if IE 7]>	  <html lang="en" class="no-js ie7"> <![endif]-->
<!--[if IE 8]>	  <html lang="en" class="no-js ie8"> <![endif]-->
<!--[if gt IE 8]><!-->
%html.no-js{ :lang => "en" }
	<!--<![endif]-->
	%head
		%meta{ :charset => "utf-8" }/
		
		-# Always force latest IE rendering engine (even in intranet) & Chrome Frame
		-# Remove this if you use the .htaccess
		%meta{ "http-equiv" => "X-UA-Compatible", :content => "IE=edge,chrome=1" }/
		
		%title Andrew Pilsch
		%meta{ :name => "viewport", :content => "width=device-width, initial-scale=1.0" }/
		
		- # Basic Goldilocks Approach CSS structure
		= javascript_include_tag("vendor/modernizr/modernizr-2.6.2.min.js")
		= stylesheet_link_tag("fonts/entypo.css", :media => "all", :rel => "stylesheet" )
		= stylesheet_link_tag("global.css", :media => "all", :rel => "stylesheet" )
		= stylesheet_link_tag("layout.css", :media => "all and (min-width: 33.236em)", :rel => "stylesheet" )
		:javascript
			// Set up our magic numbers (these are generated by Middleman):
			var $col1 = #{@col1};
			var $col2 = #{@col2};
			var $col3 = #{@col3};
			var $col4 = #{@col4};
			
			var $colh1 = #{@colh1};
			var $colh2 = #{@colh2};
			var $colh3 = #{@colh3};
			var $colh4 = #{@colh4};
			
			var $column_margin = #{@column_margin};
			var $column_border = #{@column_border};
			var $column_padding = #{@column_padding};
			var $column_height = #{@column_height};
			
			var $sidebar_width = #{@sidebar_width + @sidebar_padding * 2};
			
			var $column_width = $col1 + ($column_margin + $column_border + $column_padding) * 2;
			var $large_box_size = [$col3, $column_height * 2 + ($column_margin + $column_border + $column_padding) * 2];
			
			var $minimum_number_of_columns = 1;
			var $minimum_content_width = $minimum_number_of_columns * ($col1 + ($column_margin + $column_border + $column_padding) * 2);
		
		%body				
			.content.clearfix
				=yield

			#help
				:markdown
					Click on any of the boxes marked with a "+" to read more.
			
			-#/Load jQuery From Google, if possible
			-#%script{ :src => "//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.js" }
			-#:javascript
			-#	window.jQuery || document.write("<script src='#{javascript_path 'vendor/jquery/jquery.min.js'}'>\x3C/script>")
			- # Load jQuery Plugins
			= #load_jquery_plugins
			
			/ Fix IE CSS Selectors:
			<!--[if (gte IE 6)&(lte IE 8)]>
			/ Add javascript support for CSS selectors to old version of IE
			= javascript_include_tag("vendor/selectivizr/selectivizr.min.js")
			<![endif]-->
			
			/ Local javascript files:
			= javascript_include_tag("plugins.js")
			:javascript
				function basename(path) {
				    return path.replace(/\\/g,'/').replace( /.*\//, '' );
				}
				Modernizr.load([
					// First, we load jQuery from Google CDN and jQuery Isotope from local sources:
					{
						load: [
							'//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js',
							'#{javascript_path 'vendor/jquery/plugins/jquery.isotope.min.js'}'
						],
						callback: function (url, result, key) {
							url = basename(url);
							if(url == "jquery.min.js" && !window.jQuery) {
								yepnope('#{javascript_path 'vendor/jquery/jquery.min.js'}');
							}
						}
					},
					// Then, we test for the mobile or full version of the site, using the same
					// media query for the CSS files, above:
					{
						test: Modernizr.mq("all and (min-width: 33.236em)"),
						yep: [
							// We only need hashchange on the full site:
							'#{javascript_path 'vendor/jquery/plugins/jquery.hashchange.min.js'}',
							'#{javascript_path 'site.js'}'
						],
						nope: [
							'#{javascript_path 'mobile.js'}'
						],
						callback: function (url, result, key) {
							url = basename(url);
							if(url == "site.js") {
								start_isotope();
							} else if (url == "mobile.js") {
								start_mobile_isotope();
							}
						}
					}
				]);
			:javascript
				var _gaq = _gaq || [];
				_gaq.push(['_setAccount', 'UA-660356-1']);
				_gaq.push(['_trackPageview']);

				(function() {
					var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
					ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
					var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
				})();